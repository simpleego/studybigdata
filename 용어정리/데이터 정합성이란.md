##  데이터 정합성(Data Integrity)은 데이터가 **정확하고 일관되며 신뢰할 수 있는 상태**를 유지하는 걸 의미
> “데이터가 서로 맞아떨어지고, 틀리지 않게 잘 연결되어 있는가?”를 확인

---

## 🧭 데이터 정합성이란?

📌 **정의**:  
데이터 간의 관계, 형식, 값 등이 **논리적으로 일치하고 오류 없이 유지되는 상태**를 말해요.

📌 **목적**:
- 시스템 간 데이터 불일치 방지
- 사용자 신뢰 확보
- 분석/보고서의 정확성 보장

📌 **유형**:
| 유형             | 설명                                                                 |
|------------------|----------------------------------------------------------------------|
| 참조 정합성       | 외래키 등으로 연결된 데이터가 실제 존재해야 함                       |
| 도메인 정합성     | 값이 정의된 범위나 형식에 맞아야 함                                   |
| 엔티티 정합성     | 기본키가 중복되지 않고 고유해야 함                                     |
| 비즈니스 정합성   | 업무 규칙에 따라 데이터가 논리적으로 맞아야 함                         |

---

## 📋 간단한 예시: 쇼핑몰 주문 데이터 정합성

### 🎯 시나리오
사용자가 상품을 주문하면, 주문 테이블과 상품 테이블이 연결되어야 함.

### ✅ 정합성 예시

#### 1. 참조 정합성
- `order_items` 테이블의 `product_id`가 `products` 테이블에 실제로 존재해야 함  
  → 없는 상품을 주문하면 안 됨!

#### 2. 도메인 정합성
- `quantity`는 0보다 큰 정수여야 함  
  → `-1`이나 `abc` 같은 값은 오류!

#### 3. 엔티티 정합성
- `order_id`는 중복되면 안 됨  
  → 각 주문은 고유해야 함

#### 4. 비즈니스 정합성
- `total_amount`는 각 상품의 `price × quantity`의 합과 일치해야 함  
  → 계산이 틀리면 정합성 오류!

---

## 🧪 예시 데이터

```plaintext
orders
| order_id | user_id | total_amount |
|----------|---------|--------------|
| ORD001   | U001    | 30000        |

order_items
| item_id | order_id | product_id | quantity | price |
|---------|----------|------------|----------|-------|
| IT001   | ORD001   | P001       | 2        | 10000 |
| IT002   | ORD001   | P002       | 1        | 10000 |
```

✅ `total_amount = 2×10000 + 1×10000 = 30000` → 정합성 OK  
❌ 만약 `total_amount = 25000`이면 → 정합성 오류!

---

## 🛠️ 정합성 유지 방법

- **제약 조건 설정** (PK, FK, CHECK 등)
- **데이터 검증 로직** 추가
- **ETL 과정에서 정합성 검사**
- **정기적인 데이터 품질 점검**

---

혹시 실무에서 정합성 오류를 자동으로 탐지하거나, 정합성 테스트를 설계하는 방법도 궁금하세요? 예를 들어 SQL로 정합성 체크하는 쿼리도 만들어드릴 수 있어요.
